"use strict";(self["webpackChunkmessenger_app"]=self["webpackChunkmessenger_app"]||[]).push([[861],{4861:function(e,t,s){s.r(t),s.d(t,{default:function(){return ne}});var a=s(3396),r=s(7139);const l={class:"flex h-full w-full bg-gradient-to-r from-primary-200 to-purple-200 bg-clip-text"};function o(e,t,s,o,i,n){const c=(0,a.up)("contacts-list"),d=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(c,{class:(0,r.C_)(["h-full md:min-w-[300px] sm:min-w-[210px] md:max-w-[300px]",{"hidden sm:flex":e.chatOpened,"w-full":!e.chatOpened}])},null,8,["class"]),e.getUser?((0,a.wg)(),(0,a.j4)(d,{key:0,class:(0,r.C_)(["h-full",{"hidden sm:block":!e.chatOpened,"sm:w-full overflow-hidden":e.chatOpened}])},null,8,["class"])):(0,a.kq)("",!0)])}var i=s(65);const n={class:"flex flex-col gap-[calc(3*0.25rem_-_2px)] h-full bg-gray-200 dark:bg-gray-700 py-3 overflow-hidden w-[300px]"},c={class:"flex justify-between items-center"},d={key:0,class:"flex flex-col flex-1 w-full overflow-x-hidden overflow-y-scroll scrollbar-hide"},u={key:1,class:"flex-1 items-center px-3 text-center"},g={key:0,class:"h-full flex flex-col w-full justify-center gap-2"},h=(0,a._)("p",{class:"font-semibold text-gray-700 dark:text-gray-300"},"Чатов пока нет!",-1),p=(0,a._)("small",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400"},"Чтобы начать, используйте функцию поиска внизу",-1),m=[h,p],f={key:1,class:"h-full flex flex-col w-full justify-center items-center gap-4"},y={class:"text-xs font-semibold text-gray-500 dark:text-gray-400"},x={key:2,class:"h-full flex flex-col w-full justify-center gap-2"},w=(0,a._)("p",{class:"font-semibold text-gray-700 dark:text-gray-300"},"Тут никого :(",-1),v=(0,a._)("small",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400"},"Пользователя с поможим именем не найдено",-1),b=[w,v],k={key:2,class:"h-full flex flex-col w-full justify-center items-center gap-4"},_=(0,a._)("p",{class:"text-xs text-center font-semibold text-gray-700 dark:text-gray-300"},[(0,a.Uk)("Очень старательно загружаемся, "),(0,a._)("br"),(0,a.Uk)(" чтобы потом "),(0,a._)("strong",null,"быстрее ⚡"),(0,a.Uk)(" работать!")],-1);function C(e,t,s,l,o,i){const h=(0,a.up)("base-search-input"),p=(0,a.up)("contact-item"),w=(0,a.up)("base-loader");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("header",c,[(0,a.Wm)(h,{modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=t=>e.search=t),placeholder:"Поиск по контактам",loading:e.loading,class:"mx-2 w-full"},null,8,["modelValue","loading"])]),!e.users.length||e.loading||e.contactsFetching?e.contactsFetching?((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(w,{size:"medium"}),_])):((0,a.wg)(),(0,a.iD)("div",u,[e.search||e.loading?e.loading?((0,a.wg)(),(0,a.iD)("div",f,[(0,a.Wm)(w,{size:"medium"}),(0,a._)("small",y,'Ищем пользователя с именем "'+(0,r.zw)(e.search)+'"',1)])):e.search&&!e.loading?((0,a.wg)(),(0,a.iD)("div",x,b)):(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",g,m))])):((0,a.wg)(),(0,a.iD)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.users,(e=>((0,a.wg)(),(0,a.j4)(p,{key:e.uid,contact:e},null,8,["contact"])))),128))]))])}var D=s(4806),U=s.n(D);const M={class:"overflow-hidden"},S=["value","name","id","type","autocomplete","disabled","placeholder"],q={class:"w-3"},j={key:0,class:"text-red-600 dark:text-rose-400 overflow-hidden text-elipsis"};function I(e,t,s,l,o,i){const n=(0,a.up)("base-loader");return(0,a.wg)(),(0,a.iD)("div",M,[(0,a._)("div",{class:(0,r.C_)(["border-gray-300 dark:border-gray-500 bg-gray-100 pl-3 pr-2 flex gap-1 items-center dark:focus:border-primary-100 focus:border-primary-200 transition-colors dark:bg-gray-600 dark:text-gray-300 rounded-full border overflow-hidden",{"border-primary-300 dark:border-primary-100":e.isActive}])},[(0,a._)("i",{class:(0,r.C_)(["fa-solid fa-search text-sm w-5 m-0 p-0",{"text-primary-300 dark:text-primary-100":e.isActive}])},null,2),(0,a._)("input",{value:e.modelValue||e.value,name:e.id,id:e.id,type:e.type,autocomplete:e.autocomplete,disabled:e.disabled,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...t)=>e.updateInput&&e.updateInput(...t)),onFocusin:t[1]||(t[1]=t=>e.isActive=!0),onFocusout:t[2]||(t[2]=t=>e.isActive=!1),class:"w-full h-8 text-sm outline-none dark:bg-gray-600 bg-gray-100 shadow-none"},null,40,S),(0,a._)("div",q,[this.loading?((0,a.wg)(),(0,a.j4)(n,{key:0,size:"tiny"})):(0,a.kq)("",!0)])],2),e.errorMessage?((0,a.wg)(),(0,a.iD)("small",j,(0,r.zw)(e.errorMessage),1)):(0,a.kq)("",!0)])}var A=(0,a.aZ)({name:"BaseSearchInput",props:{value:{type:String,required:!1,default:""},modelValue:{type:String,required:!1,default:""},label:{type:String,required:!1},type:{type:String,required:!1,default:"text"},errorMessage:{type:String,required:!1,default:""},autocomplete:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},placeholder:{type:String,required:!1,default:""},loading:{type:Boolean,required:!1,default:!1}},data(){return{isActive:!1,id:null}},created(){this.id="input-"+Math.random()},methods:{activateInput(){this.isActive=!0},updateInput(e){this.$emit("update:modelValue",e.target.value)}},watch:{modelValue(){this.isActive=!0}}}),z=s(89);const Z=(0,z.Z)(A,[["render",I]]);var $=Z,F=s(9242);const L={class:"flex gap-3 items-center overflow-hidden w-full"},V={class:"min-h-[2.5rem] min-w-[2.5rem] w-[2.5rem] h-[2.5rem] rounded-full bg-gray-300 overflow-hidden"},B=["src"],O={class:"flex flex-col overflow-hidden w-full"},Q={class:"w-full flex overflow-hidden justify-between items-center"},R={class:"flex w-full flex-col overflow-hidden"},W={class:"flex-1 text-sm font-semibold overflow-hidden text-ellipsis whitespace-nowrap dark:text-gray-300 text-gray-700"},H={key:0,class:"flex w-full justify-between overflow-hidden text-sm whitespace-nowrap"},N={class:"overflow-hidden whitespace-nowrap text-ellipsis dark:text-gray-400 text-gray-600 font-semibold flex-1 pr-2"},T={class:"dark:text-gray-300 text-gray-700"},K={class:"text-end inline-block overflow-hidden whitespace-nowrap text-ellipsis dark:text-gray-400 text-gray-600 font-semibold"},Y={class:"relative h-[2rem] bg-red-400"},E={key:0,class:"flex items-center justify-center text-xs h-[1rem] min-w-[1rem] p-1 rounded-full bg-green-300 text-gray-700 font-bold absolute right-0 top-0 group-hover:opacity-0 transition-opacity"},G=(0,a._)("i",{class:"fa-solid fa-bars"},null,-1),J=[G];function P(e,t,s,l,o,i){const n=(0,a.Q2)("tooltip");return(0,a.wg)(),(0,a.iD)("div",{class:(0,r.C_)(["cursor-pointer min-h-[3.5rem] flex items-center justify-between overflow-hidden hover:bg-gray-300 dark:hover:bg-gray-600 px-2 transition-colors group",{"bg-gray-300 dark:bg-gray-600":e.$route.params.chatId===e.contact.uid}]),onClick:t[1]||(t[1]=(...t)=>e.onClick&&e.onClick(...t))},[(0,a._)("div",L,[(0,a._)("div",V,[e.contact.photoURL?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.contact.photoURL,alt:"",class:"h-full w-full object-cover"},null,8,B)):(0,a.kq)("",!0)]),(0,a._)("div",O,[(0,a._)("div",Q,[(0,a._)("div",R,[(0,a._)("p",W,(0,r.zw)(e.contact.name),1),e.lastMessage?((0,a.wg)(),(0,a.iD)("div",H,[(0,a._)("small",N,[(0,a._)("span",T,(0,r.zw)(e.lastMessage?.sended_by_name)+":",1),(0,a.Uk)(" "+(0,r.zw)(e.lastMessage?.content),1)]),(0,a._)("small",K,(0,r.zw)(e.getTimeFromDate(e.lastMessage?.created_at)),1)])):(0,a.kq)("",!0)]),(0,a._)("div",Y,[e.unreadMessages?((0,a.wg)(),(0,a.iD)("div",E,(0,r.zw)(e.unreadMessages),1)):(0,a.kq)("",!0),(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{onClick:t[0]||(t[0]=(0,F.iM)((()=>{}),["stop"])),class:"flex items-center justify-center sm:text-sm text-xl h-[1rem] min-w-[1rem] p-1 text-gray-700 dark:text-gray-300 font-bold absolute right-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-gray-800 hover:dark:text-gray-200"},J)),[[n,"Настройки чата"]])])])])])],2)}s(7658);var X=s(1727),ee=(0,a.aZ)({name:"ContactItem",data:()=>({firstUpload:!0}),props:{contact:{type:Object,required:!0}},methods:{getTimeFromDate:X.D,...(0,i.nv)("room",["setChatListenerByRoomHash"]),onClick(){this.$router.push({name:"chat",params:{chatId:this.contact.uid}})}},computed:{uid(){return this.$store.getters["auth/getUser"]?.uid},chatId(){return this.$route.params.chatId},lastMessage(){const e=this.$store.getters["room/getLastRoomMessage"](this.contact.room_hash);return e},unreadMessages(){return this.$store.getters["room/getUnreadMessagesAmount"](this.contact.room_hash)}}});const te=(0,z.Z)(ee,[["render",P]]);var se=te,ae=(0,a.aZ)({name:"ContactsList",components:{BaseSearchInput:$,ContactItem:se},data:()=>({search:"",debouncedQuery:null,loading:!1,contactsFetching:!1,contactsListener:null,users:[]}),async created(){this.users=await this.getSortedContacts()||[]},watch:{async search(e){this.debouncedQuery&&(this.debouncedQuery.cancel(),this.loading=!1),e.length?(this.searchContact(e),this.users.length||(this.debouncedQuery=U().debounce(this.searchUser,400),this.debouncedQuery(e),this.loading=!0)):this.users=await this.getSortedContacts()||[]},getAllMessages:{async handler(){this.search.length||(this.users=await this.getSortedContacts())},deep:!0}},methods:{...(0,i.nv)("contacts",{getUser:"fetchUsersByName",getSortedContacts:"getSortedContacts"}),searchContact(e){this.users=this.getContact(e)},async searchUser(e){this.users=await this.getUser({name:e}),this.loading=!1}},computed:{...(0,i.Se)("auth",{currUser:"getUser"}),...(0,i.Se)("contacts",{getContact:"getContact"}),contactsNames(){return this.getContacts.map((e=>e.name))},...(0,i.Se)("room",{getAllMessages:"getAllMessages"})}});const re=(0,z.Z)(ae,[["render",C]]);var le=re,oe=(0,a.aZ)({components:{ContactsList:le},computed:{chatOpened(){return!!this.$route.params.chatId},...(0,i.Se)("auth",["getUser"])}});const ie=(0,z.Z)(oe,[["render",o]]);var ne=ie}}]);
//# sourceMappingURL=861.c786d879.js.map