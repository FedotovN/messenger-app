"use strict";(self["webpackChunkmessenger_app"]=self["webpackChunkmessenger_app"]||[]).push([[865],{6270:function(e,s){s.Z={"auth/user-not-found":"Пользователь не найден 👻","auth/email-already-in-use":"Почта занята ☝️","auth/invalid-email":"Неправильный email 🧠","auth/wrong-password":"Неверный пароль 🧠","auth/network-request-failed":"Ошибка подключения 🔌","auth/email-not-verified":"Требуется подтвердить почту 🦾","auth/popup-closed-by-user":"Форма отклонена ✋","auth/not-authorized":"Необходима авторизация 🔒","auth/session-closed":"Вы вышли из аккаунта 👋","auth/logged-in":"Добро пожаловать 👋","auth/too-many-requests":"Много запросов, приходите позже 🔒","auth/verifying-link":"Ссылка-подтверждение отправлена на почту ✔️"}},8060:function(e,s,t){t.d(s,{Z:function(){return Z}});var a=t(3396),r=t(7139),l=t(9242);const i={class:"flex flex-1 h-full w-full"},o={class:"flex flex-col gap-4"},n={class:"text-gray-600 dark:text-gray-400"},u={class:"grid grid-cols-6 gap-2"},c=(0,a._)("i",{class:"fa-solid fa-angle-left"},null,-1),d=[c],h=(0,a._)("i",{class:"fa-solid fa-angle-right"},null,-1),p=[h],m={key:2,class:"flex h-full w-full items-center justify-center flex-col gap-2 text-center py-4"},w={class:"font-semibold text-gray-700 dark:text-gray-300"},f={class:"text-gray-400"};function g(e,s,t,c,h,g){const x=(0,a.up)("base-button"),y=(0,a.up)("base-modal"),k=(0,a.up)("user-card");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(y,{modelValue:h.showModal,"onUpdate:modelValue":s[1]||(s[1]=e=>h.showModal=e)},{header:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$t("operations.users.delete",{msg:h.chosenUser?.name})),1)])),default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("small",n,(0,r.zw)(e.$t("phrases.sure")),1),(0,a._)("div",u,[(0,a.Wm)(x,{class:"col-span-4",onClick:s[0]||(s[0]=e=>h.showModal=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$t("phrases.no")),1)])),_:1}),(0,a.Wm)(x,{class:"col-span-2",theme:"alert",onClick:g.onRemove},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$t("phrases.yes")),1)])),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),h.users?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,r.C_)([t.forceListView?"grid":"sm:hidden grid","py-4 grid-cols-[repeat(auto-fill,minmax(100px,1fr))] grid-rows-[repeat(auto-fit,180px)] w-full max-h-full gap-x-4 scrollbar-hide"])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.users,(e=>((0,a.wg)(),(0,a.j4)(k,{user:e,class:"transition-all col-span-1 justify-self-center",onRemove:s=>g.removeUser(e),key:e?.uid},null,8,["user","onRemove"])))),128))],2)):(0,a.kq)("",!0),h.users?((0,a.wg)(),(0,a.iD)("div",{key:1,class:(0,r.C_)([t.forceListView?"hidden":"sm:flex hidden","items-center relative overflow-hidden w-full"])},[h.page>1?((0,a.wg)(),(0,a.iD)("div",{key:0,onClick:s[2]||(s[2]=(0,l.iM)((e=>h.page--),["stop"])),class:"bg-[rgba(255,255,255,0.7)] rounded-x-xl z-10 absolute left-0 opacity-0 transition-all hover:opacity-100 h-full w-[42px] cursor-pointer flex justify-center items-center"},d)):(0,a.kq)("",!0),h.users?((0,a.wg)(),(0,a.iD)("div",{key:1,class:"flex py-6 items-center relative w-full transition-all",style:(0,r.j5)(`transform: translateX(-${400*(h.page-1)}px)`)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.users,(e=>((0,a.wg)(),(0,a.j4)(k,{user:e,class:"transition-all py-2",onRemove:s=>g.removeUser(e),key:e?.uid},null,8,["user","onRemove"])))),128))],4)):(0,a.kq)("",!0),h.page<g.pagesCount?((0,a.wg)(),(0,a.iD)("div",{key:2,onClick:s[3]||(s[3]=(0,l.iM)((e=>h.page++),["stop"])),class:"bg-[rgba(255,255,255,0.7)] rounded-x-xl z-10 absolute right-0 opacity-0 transition-all hover:opacity-100 h-full w-[42px] cursor-pointer flex justify-center items-center"},p)):(0,a.kq)("",!0)],2)):((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("p",w,(0,r.zw)(e.$t("fallbacks.noUsers")),1),(0,a._)("small",f,(0,r.zw)(e.$t("fallbacks.createUser")),1)]))])}const x={key:0,class:"user-card"},y={class:"flex flex-col sm:gap-2 gap-4 items-center cursor-pointer sm:w-[100px] w-[120px] h-auto transition-all relative",ref:"tippyWrapper"},k={class:"w-32 flex flex-col gap-2 py-2 px-1"},v={class:"flex justify-between items-center h-3 w-full"},b={class:"whitespace-nowrap overflow-hidden text-ellipsis"},_={class:"sm:h-16 sm:w-16 w-24 h-24 rounded-full bg-gray-200 transition-all overflow-hidden"},U=["src"],$={class:"flex flex-col items-center gap-1 w-26 text-center"},C={class:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis w-[90px]"};function z(e,s,t,i,o,n){const u=(0,a.up)("base-loader"),c=(0,a.up)("base-tooltip");return t.user?((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("div",y,[(0,a.Wm)(c,{options:{arrow:!1,trigger:"click"},onClick:n.closeMenu},{default:(0,a.w5)((()=>[(0,a._)("div",k,[(0,a._)("div",v,[(0,a._)("small",b,(0,r.zw)(t.user.name),1),o.loading?((0,a.wg)(),(0,a.j4)(u,{key:0,size:"tiny"})):(0,a.kq)("",!0)]),(0,a._)("small",{class:"text-xs text-blue-600 dark:text-blue-400 py-1 hover:text-blue-70 transition-colors cursor-pointer",onClick:s[0]||(s[0]=(...e)=>n.enter&&n.enter(...e))},(0,r.zw)(e.$t("form.buttons.signIn")),1),(0,a._)("small",{class:"text-xs text-blue-600 dark:text-blue-400 py-1 hover:text-blue-70 transition-colors cursor-pointer",onClick:s[1]||(s[1]=(...e)=>n.remove&&n.remove(...e))},(0,r.zw)(e.$t("form.buttons.remove")),1),(0,a._)("small",{class:"text-xs text-blue-600 dark:text-blue-400 py-1 hover:text-blue-70 transition-colors cursor-pointer",onClick:s[2]||(s[2]=(...e)=>n.edit&&n.edit(...e))},(0,r.zw)(e.$t("form.buttons.edit")),1)])])),_:1},8,["onClick"]),(0,a._)("div",_,[t.user.photoUrl?((0,a.wg)(),(0,a.iD)("img",{key:0,src:t.user.photoUrl,class:"h-full w-full object-cover"},null,8,U)):(0,a.kq)("",!0)]),(0,a._)("div",$,[(0,a.wy)((0,a._)("p",{class:"sm:text-xs text-center font-semibold whitespace-nowrap overflow-hidden text-ellipsis w-[90px] text-gray-700 dark:text-gray-300"},(0,r.zw)(t.user.name),513),[[l.F8,t.user.name]]),(0,a._)("small",C,(0,r.zw)(t.user.email),1)])],512)])):(0,a.kq)("",!0)}t(7658);var j={name:"UserCard",props:{user:{type:Object,required:!0}},data(){return{imageLoading:!1,loading:!1}},methods:{openMenu(){this.$refs.tippyWrapper._tippy.show()},closeMenu(){this.$refs.tippyWrapper._tippy.hide()},async edit(){this.loading=!0;try{await this.$store.dispatch("auth/signInWithEmail",{email:this.user.email,password:this.user.password}),this.$router.push({name:"profile-edit",params:{uid:this.user.uid},query:{fallback:this.$route.name}})}catch(e){console.warn(e)}this.closeMenu()},remove(){this.closeMenu(),this.$emit("remove")},async enter(){this.loading=!0;try{await this.$store.dispatch("auth/signInWithEmail",{email:this.user.email,password:this.user.password}),this.$router.push({name:"main",query:{message:"auth/logged-in"}})}catch(e){console.warn(e)}}}},q=t(89);const M=(0,q.Z)(j,[["render",z]]);var D=M,W={props:{forceListView:{type:Boolean,required:!1}},name:"UserList",components:{UserCard:D},data(){return{users:[],maxElementsPerPage:4,page:1,showModal:!1,chosenUser:null}},computed:{pagesCount(){return Math.ceil(this.users?.length/this.maxElementsPerPage)}},async mounted(){this.users=await this.$store.dispatch("auth/getCachedUsers")},methods:{removeUser(e){this.chosenUser=e,this.showModal=!0},async onRemove(){await this.$store.dispatch("auth/removeCachedUser",this.chosenUser.uid),this.users=await this.$store.dispatch("auth/getCachedUsers"),this.showModal=!1}}};const L=(0,q.Z)(W,[["render",g]]);var Z=L},865:function(e,s,t){t.r(s),t.d(s,{default:function(){return f}});var a=t(3396),r=t(7139);const l={class:"flex flex-col bg-white dark:bg-dark-200 sm:shadow sm:rounded h-full sm:h-auto w-full px-3 sm:max-w-[450px]"},i={class:"flex items-center py-2 border-gray-200 dark:border-gray-500 border-b-2 w-full"},o={class:"font-semibold py-2 flex-1 flex justify-between text-gray-700 dark:text-gray-300"},n={class:"flex relative overflow-y-scroll flex-1 scrollbar-hide"},u={class:"flex justify-between w-full pb-4 items-center"};function c(e,s,t,c,d,h){const p=(0,a.up)("base-loader"),m=(0,a.up)("user-list"),w=(0,a.up)("base-link");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("header",i,[(0,a._)("p",o,[(0,a.Uk)((0,r.zw)(e.$t(d.message))+" ",1),d.loading?((0,a.wg)(),(0,a.j4)(p,{key:0})):(0,a.kq)("",!0)])]),(0,a._)("main",n,[(0,a.Wm)(m,{onLogin:h.login},null,8,["onLogin"])]),(0,a._)("footer",null,[(0,a._)("div",u,[(0,a.Wm)(w,{to:"/login",class:"sm:text-xs"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$t("links.internal.back")),1)])),_:1})])])])}t(7658);var d=t(6270),h=t(8060),p={components:{UserList:h.Z},data(){return{loading:!1,message:"titles.users"}},methods:{async login(){this.loading=!0,this.message="auth.phrases.login";try{await this.$store.dispatch("auth/signInWithEmail",{email:this.chosenUser.email,password:this.chosenUser.password}),this.$router.push("/")}catch(e){this.message=d.Z[e.code]||e}finally{this.loading=!1}}}},m=t(89);const w=(0,m.Z)(p,[["render",c]]);var f=w}}]);
//# sourceMappingURL=865.d4632994.js.map